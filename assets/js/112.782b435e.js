(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{376:function(t,a,s){"use strict";s.r(a);var e=s(13),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"如何实现网页多标签tab通讯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如何实现网页多标签tab通讯"}},[t._v("#")]),t._v(" 如何实现网页多标签tab通讯")]),t._v(" "),a("h3",{attrs:{id:"场景说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#场景说明"}},[t._v("#")]),t._v(" 场景说明")]),t._v(" "),a("p",[t._v("tab 列表页待处理数量和详情页待处理数量同步统一")]),t._v(" "),a("img",{attrs:{src:t.$withBase("/assets/notes-images/breadth/tab.png"),alt:"tab",width:"500"}}),t._v(" "),a("h3",{attrs:{id:"_1-websocket-实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-websocket-实现"}},[t._v("#")]),t._v(" 1. WebSocket 实现")]),t._v(" "),a("p",[t._v("WebSocket 特性：")]),t._v(" "),a("ul",[a("li",[t._v("无跨域限制")]),t._v(" "),a("li",[t._v("需要服务器支持，成本高")]),t._v(" "),a("li",[t._v("实现方式：网页操作后，发送到服务器，服务器接收到消息后，同步到其他页面中")]),t._v(" "),a("li",[t._v("如果遇到断网的情况，也会有不同步的情况")])]),t._v(" "),a("h3",{attrs:{id:"_2-localstorage-实现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-localstorage-实现"}},[t._v("#")]),t._v(" 2. localStorage 实现")]),t._v(" "),a("p",[t._v("适用于同域通讯，localStorage 跨域不共享")]),t._v(" "),a("ul",[a("li",[t._v("同域的 A 和 B 页面")]),t._v(" "),a("li",[t._v("A 页面设置localStorage，window.setLocalStorage('name', value)")]),t._v(" "),a("li",[t._v("B 页面可监听到 localStorage 值的变化, 通过 storage 方法监听")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 页面A")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setLocalStorage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'score'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 页面B")]),t._v("\nwindow"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'storage'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'key'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// score")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'value'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" event"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 100")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),a("h3",{attrs:{id:"sharedworker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sharedworker"}},[t._v("#")]),t._v(" SharedWorker")]),t._v(" "),a("p",[t._v("必须是同域，不支持跨域")]),t._v(" "),a("ul",[a("li",[t._v("SharedWorker 是 WebWorker 的一种")]),t._v(" "),a("li",[t._v("WebWorker 可开启子进程执行 JS，但不能操作 DOM")]),t._v(" "),a("li",[t._v("SharedWorker 可单独开启一个进程，用于"),a("code",[t._v("同域")]),t._v("页面通讯")])]),t._v(" "),a("img",{attrs:{src:t.$withBase("/assets/notes-images/breadth/shareWorker.png"),alt:"shareWorker",width:"500"}}),t._v(" "),a("h3",{attrs:{id:"比较"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#比较"}},[t._v("#")]),t._v(" 比较")]),t._v(" "),a("ul",[a("li",[t._v("WebSocket 需要服务端支持，成本较高，无跨域限制")]),t._v(" "),a("li",[t._v("localStorage 简单易用，推荐，默认跨域不共享")]),t._v(" "),a("li",[t._v("SharedWorker 调试不方便，不兼容IE11，跨域限制")])])])}),[],!1,null,null,null);a.default=n.exports}}]);